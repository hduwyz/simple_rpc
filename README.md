# simple_rpc

### 1、rpc框架需要涉及到的东西：
  - 动态代理
  - 反射
  - 序列化、反序列化
  - 网络通信
  - 编解码
  - 服务发现和注册
  - 心跳与链路检测
  。。。。。
### 2、简单rpc需要用到的技术框架
   - springboot:项目的基础框架，方便打成jar包，便于测试；
   - netty:通信服务器
   - zookeeper:服务的发现与注册
   - zkclient:zookeeper客户端
   - fastjson:序列化、反序列化
### 3、rpc生产者
  - 服务接口API：rpc分为生产者和消费者，需要定义一套共同的服务接口api（InfoUserService接口）
  - 服务类实现：生产者实现接口类（InfoUserServiceImpl）,然后用注解标注成rpc服务，然后注册到spring的Bean容器。
  - 请求信息和返回信息：所有的请求信息和返回信息，且返回信息需要带有请求信息的id
  - netty服务端:启动netty进行处理
  - 服务注册：把服务注册到zookeeper中。
  - ***加载服务并缓存---->启动通讯服务器（netty)----->服务注册（通讯地址放到zookeeper,也可以将加载的服务放进去）----->反射，本地调用***
### 4、rpc消费者
  - 代理：消费端调用方法时，先调用到代理对象的invoke方法，在这里先封装请求信息，然后调用netty客户端方法发送信息，
          最后根据方法返回值类型，转换成相应的对象。
  - 服务发现：生产者将服务注册到zookeeper上，消费者去zookeeper上拿到服务地址，并且对zookeeper进行监听，
             一旦服务地址变换，更新本地缓存地址，然后再通过netty连接服务。
  - netty客户端：有两个职责（一个根据ip加端口去连接服务器，返回channel并加入到连接管理器，二是通过channel发送请求数据，并且需要在空闲时发送心跳。）
  - ***代理服务接口---->服务发现（连接zookeeper，拿到服务地址列表）------->远程调用（轮询生产者服务列表，发送消息)***
